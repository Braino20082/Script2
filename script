-- LocalScript in StarterGui
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AdminPanelGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

-- Hauptframe
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 350, 0, 500)
MainFrame.Position = UDim2.new(0, 20, 0.5, -250)
MainFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
MainFrame.Active = true
MainFrame.Draggable = true -- verschiebbar
MainFrame.Parent = ScreenGui

local corner = Instance.new("UICorner", MainFrame)
corner.CornerRadius = UDim.new(0.05,0)

-- Titel
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1,0,0,40)
Title.BackgroundTransparency = 1
Title.Text = "Event Starter"
Title.TextColor3 = Color3.fromRGB(220,220,220)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 24
Title.Parent = MainFrame

-- Schließen Button
local Close = Instance.new("TextButton")
Close.Size = UDim2.new(0,40,0,30)
Close.Position = UDim2.new(1,-45,0,5)
Close.Text = "X"
Close.Font = Enum.Font.GothamBold
Close.TextColor3 = Color3.fromRGB(255,100,100)
Close.BackgroundColor3 = Color3.fromRGB(70,70,70)
Close.Parent = MainFrame
local cc = Instance.new("UICorner", Close)
cc.CornerRadius = UDim.new(0.3,0)

Close.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- ScrollFrame für Events
local Scroll = Instance.new("ScrollingFrame")
Scroll.Size = UDim2.new(1,-10,1,-50)
Scroll.Position = UDim2.new(0,5,0,45)
Scroll.BackgroundTransparency = 1
Scroll.ScrollBarThickness = 6
Scroll.CanvasSize = UDim2.new(0,0,0,0)
Scroll.Parent = MainFrame

local Layout = Instance.new("UIListLayout", Scroll)
Layout.SortOrder = Enum.SortOrder.LayoutOrder
Layout.Padding = UDim.new(0,5)

Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    Scroll.CanvasSize = UDim2.new(0,0,0, Layout.AbsoluteContentSize.Y + 10)
end)

-- RemoteEvents einsammeln
local function getAllRemoteEvents()
    local events = {}
    for _, v in pairs(game:GetDescendants()) do
        if v:IsA("RemoteEvent") then
            table.insert(events, v)
        end
    end
    return events
end

-- Event-Button erstellen
local function createEventButton(event)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1,-10,0,35)
    btn.BackgroundColor3 = Color3.fromRGB(90,90,90)
    btn.TextColor3 = Color3.fromRGB(220,220,220)
    btn.Font = Enum.Font.Gotham
    btn.TextScaled = true
    btn.Text = "Event: "..event.Name
    btn.Parent = Scroll

    local bcorner = Instance.new("UICorner", btn)
    bcorner.CornerRadius = UDim.new(0.1,0)

    btn.MouseButton1Click:Connect(function()
        if event and event:IsA("RemoteEvent") then
            warn("Starte Event -> "..event:GetFullName())
            local ok, err = pcall(function()
                event:FireServer()
            end)
            if not ok then
                warn("Fehler beim FireServer: "..tostring(err))
            end
        else
            warn("Ungültiges RemoteEvent.")
        end
    end)
end

-- Alle RemoteEvents einfügen
local remotes = getAllRemoteEvents()
warn("Gefundene RemoteEvents: "..#remotes)
for _, r in ipairs(remotes) do
    createEventButton(r)
end
