-- Rtx Float v2 GUI - Enhanced Version
-- Features: Float, Player ESP, NPC-Shop Buttons, Draggable, Gradient Style

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

-- GUI Container
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "RtxFloatV2"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 260, 0, 200)
MainFrame.Position = UDim2.new(0.35, 0, 0.1, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

-- Rounded Corners
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0.2,0)
UICorner.Parent = MainFrame

-- Gradient Outline
local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 3
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
UIStroke.Parent = MainFrame

local UIGradient = Instance.new("UIGradient")
UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0,255,0)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0,180,0))
}
UIGradient.Rotation = 45
UIGradient.Parent = UIStroke

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1,0,0,35)
Title.BackgroundTransparency = 1
Title.Text = "Rtx Float v2"
Title.TextColor3 = Color3.fromRGB(0,255,0)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 22
Title.Parent = MainFrame

-- Utility function to create styled buttons
local function createButton(name, text, position, parent)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(0.8,0,0,40)
    button.Position = position
    button.Text = text
    button.BackgroundColor3 = Color3.fromRGB(30,30,30)
    button.TextColor3 = Color3.fromRGB(0,255,0)
    button.Font = Enum.Font.GothamBold
    button.TextScaled = true
    button.ClipsDescendants = true
    button.Parent = parent

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.2,0)
    corner.Parent = button

    local outline = Instance.new("UIStroke")
    outline.Thickness = 2
    outline.Parent = button

    local grad = Instance.new("UIGradient")
    grad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(0,255,0)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(0,180,0))
    }
    grad.Rotation = 45
    grad.Parent = outline

    -- Hover effect
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(40,40,40)
    end)
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(30,30,30)
    end)

    return button
end

-- Buttons
local FloatButton = createButton("FloatButton", "Float v1", UDim2.new(0.1,0,0.25,0), MainFrame)
local ESPButton = createButton("ESPButton", "Player ESP: OFF", UDim2.new(0.1,0,0.5,0), MainFrame)
local ShopButton = createButton("ShopButton", "NPC Shop", UDim2.new(0.1,0,0.75,0), MainFrame)

-- Dragging Logic
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y
        )
    end
end)

-- Float Logic
local floatEnabled = false
local floatConnection
local function toggleFloat()
    floatEnabled = not floatEnabled
    if floatEnabled then
        FloatButton.Text = "Float ON"
        floatConnection = RunService.RenderStepped:Connect(function()
            if Character and HumanoidRootPart then
                local moveDir = workspace.CurrentCamera.CFrame.LookVector
                HumanoidRootPart.Velocity = moveDir * 26 + Vector3.new(0, 9, 0)
            end
        end)
    else
        FloatButton.Text = "Float v1"
        if floatConnection then floatConnection:Disconnect() end
        HumanoidRootPart.Velocity = Vector3.zero
    end
end
FloatButton.MouseButton1Click:Connect(toggleFloat)

-- ESP Logic
local espEnabled = false
local espHighlights = {}
local function addESP(player)
    if player.Character and not espHighlights[player] then
        local highlight = Instance.new("Highlight")
        highlight.FillColor = Color3.fromRGB(0,255,0)
        highlight.OutlineColor = Color3.fromRGB(0,255,0)
        highlight.FillTransparency = 0.8
        highlight.OutlineTransparency = 0
        highlight.Adornee = player.Character
        highlight.Parent = player.Character
        espHighlights[player] = highlight
    end
end
local function removeESP(player)
    if espHighlights[player] then
        espHighlights[player]:Destroy()
        espHighlights[player] = nil
    end
end
local function toggleESP()
    espEnabled = not espEnabled
    if espEnabled then
        ESPButton.Text = "Player ESP: ON"
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then addESP(player) end
        end
        Players.PlayerAdded:Connect(function(player)
            if espEnabled then addESP(player) end
        end)
        Players.PlayerRemoving:Connect(function(player)
            removeESP(player)
        end)
    else
        ESPButton.Text = "Player ESP: OFF"
        for _, hl in pairs(espHighlights) do hl:Destroy() end
        espHighlights = {}
    end
end
ESPButton.MouseButton1Click:Connect(toggleESP)

-- NPC Shop GUI
local ShopFrame = Instance.new("Frame")
ShopFrame.Size = UDim2.new(0, 200, 0, 120)
ShopFrame.Position = UDim2.new(0.5,0,0.5,0)
ShopFrame.AnchorPoint = Vector2.new(0.5,0.5)
ShopFrame.BackgroundColor3 = Color3.fromRGB(25,25,25)
ShopFrame.BorderSizePixel = 0
ShopFrame.Visible = false
ShopFrame.Parent = ScreenGui

local ShopCorner = Instance.new("UICorner")
ShopCorner.CornerRadius = UDim.new(0.2,0)
ShopCorner.Parent = ShopFrame

local ShopTitle = Instance.new("TextLabel")
ShopTitle.Size = UDim2.new(1,0,0,30)
ShopTitle.BackgroundTransparency = 1
ShopTitle.Text = "NPC Shop"
ShopTitle.TextColor3 = Color3.fromRGB(0,255,0)
ShopTitle.Font = Enum.Font.GothamBold
ShopTitle.TextSize = 20
ShopTitle.Parent = ShopFrame

local function createShopButton(text, position)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.8,0,0,35)
    btn.Position = position
    btn.Text = text
    btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    btn.TextColor3 = Color3.fromRGB(0,255,0)
    btn.Font = Enum.Font.GothamBold
    btn.TextScaled = true
    btn.ClipsDescendants = true
    btn.Parent = ShopFrame

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.2,0)
    corner.Parent = btn

    local outline = Instance.new("UIStroke")
    outline.Thickness = 2
    outline.Parent = btn

    local grad = Instance.new("UIGradient")
    grad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(0,255,0)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(0,180,0))
    }
    grad.Rotation = 45
    grad.Parent = outline

    btn.MouseEnter:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(40,40,40) end)
    btn.MouseLeave:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(30,30,30) end)

    return btn
end

local BuyButton = createShopButton("Kaufen", UDim2.new(0.1,0,0.35,0))
local NevermindButton = createShopButton("Nevermind", UDim2.new(0.1,0,0.65,0))

BuyButton.MouseButton1Click:Connect(function()
    print("NPC Item gekauft!") -- hier kann deine Kauf-Logik
    ShopFrame.Visible = false
end)
NevermindButton.MouseButton1Click:Connect(function()
    ShopFrame.Visible = false
end)

ShopButton.MouseButton1Click:Connect(function()
    ShopFrame.Visible = not ShopFrame.Visible
end)
